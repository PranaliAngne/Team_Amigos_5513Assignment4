---
title: "Amigos_Assignment4"
author: "Pranali Angne"
author: "Nishtha Arora"
author: "Raunak Bhivpathaki"
date: "5/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

The data used in the report is regarding building certification lodgements in the Townsville local government area. Townsville is a city and a major port area in eastern Queensland, Australia. The data set been extracted from [www.data.gov.au](https://data.gov.au/data/dataset/tcc-building-approvals). 

This data set includes number of building approvals from 2009 to 2021 and can be aggregated by month, suburb and local government electoral division.  

The objective of the report is to identify the year with maximum approvals and to analyze data regarding the building category maximum in demand i.e. the Suburb and total cost for that category.

\section*{1}
```{r}
library(tidyverse)
library(lubridate)
library(ggplot2)
```



```{r Reading-data}
question0 <-read_csv("data/building-approvals.csv")

summary <- colnames(question0)

knitr::kable(summary, col.names = gsub("[.]", " ", names(summary)), align = "c")
```


Above are the description of the variables used in the dataset.
+ *Date of decision notice*: The date the building certifier made a notice that the works met the building codes.

+ *Decision*: Current status of the works as recorded with Council.

+ *Class*: The building classification as per the list on page one.

+ *Sub-category (Council category descriptors)*: This category is a subdivision of class. Provides information regarding additions, alterations, subdwell etc in it.

+ *Category*: Townsville City Council has published on its website for a number of years a summary of building approval data using the certain categories.

+ *Estimated values*: The monetary value of the proposed building work.

+ *Suburb*: The suburb where the building work is taking place.

+ *Floor area*: The floor area of the building works in square metres.

+ *No. of units*: Number of individual units created or demolished by the building works.

+ *Electoral Division*: The local government electoral division in which the works are occurring.





# Q1: Which **Year** has maximum approvals regarding the building category which is maximum in demand/most favourite.

```{r }
question1 <- question0 %>% 
  mutate(`Date Of Decision Notice` = dmy(`Date Of Decision Notice`),
        Year = year(`Date Of Decision Notice`)) %>% 
  select(Year, Decision) %>% 
  count(Decision, Year) %>% 
  rename(`Total number of Decision` = n)

# plotting this graph
ggplot(data = question1, aes(x = Year,
                             y = `Total number of Decision`, 
                             fill = Decision)) +
  geom_bar(stat="identity", position = "dodge") +
  scale_fill_brewer(palette="Dark2") +
  theme_get() +
  xlab("Year") +
  ylab("Total count of Decision") 
```



\section*{2}

```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(tidyverse)
library(readr)
library(lubridate)
library(kableExtra)
```

```{r, message=FALSE, warning=FALSE, echo=FALSE}
Sec2 <- read_csv("data/building-approvals.csv")
```

Q2. Which category is most in demand/occurs maximum times in the year 2020?

```{r Filtering, message=FALSE, warning=FALSE,echo=FALSE}
Filtered <- Sec2 %>%  mutate(`Date Of Decision Notice` = dmy(`Date Of Decision Notice`),
        Year = year(`Date Of Decision Notice`)) %>% 
  filter(Year == "2020")
```

```{r}
Tab <- Filtered %>% count(Category)  %>% 
  rename(Count = n) %>% 
  arrange(desc(Count))
knitr::kable(head(Tab), caption = "Count of categories in 2020") %>% 
   kable_paper("hover", full_width = T)
```

Q3. Which is the suburb, where it costs the maximum for the category  "Residential-Other", in the year 2020?

```{r, fig.height= 5, fig.width=5}
Fig <- Filtered %>% 
  filter(Category == "Residential - Other") %>% 
  rename(Estimated_Cost = `Estimated Cost`) %>% 
mutate(Estimated.Cost = as.factor(Estimated_Cost)) 
  Fig$Estimated.Cost = as.numeric(gsub("[\\$,]", "", Fig$Estimated.Cost)) 
  
  ggplot(Fig,
         aes(x= Estimated.Cost,
             y= Suburb, fill= Category))+
    geom_col() +
    scale_x_continuous(labels = scales::comma)
    
```








\section*{Q2, Part A} 

## Answering **Research Question 2.**

``` {r library, echo= FALSE, warning= FALSE, message = FALSE}
library(tidyverse)
library(lubridate)
library(ggplot2)
library(kableExtra)
library(readr)
library(plotly)
library(RColorBrewer)
library(wesanderson)
```

```{r read, message=FALSE, warning=FALSE, echo=FALSE}
Section3 <- read_csv("data/building-approvals.csv") %>%  mutate(`Date Of Decision Notice` = dmy(`Date Of Decision Notice`),
        Year = year(`Date Of Decision Notice`))
```

### Finding the **Year** for **maximum approvals** in **Kirwan** and **Hermit Park**.

*(Keeping, 'Decision as Approved' and 'Suburbs as Kirwan and Hermit Park', constant)*

```{r fig5, echo= FALSE, warning= FALSE, message = FALSE, fig.cap= "Year v/s Approval Count with respect to Suburbs", fig.align='center', fig.height= 5, fig.width= 9}
plot <- Section3 %>% 
  filter(Suburb %in% c("Kirwan" , "Hermit Park")) %>% 
  filter(Decision %in% c("#Approved")) %>% 
   group_by(Year, Decision, Suburb) %>% 
  count(Decision) %>% 
  rename(Decision_count = n)

Fig <- ggplot(data = plot, aes(x = Year,
                             y = Decision_count, 
                             fill = Suburb)) +
  geom_bar(stat="identity", position = "dodge") +
scale_fill_manual(values = wes_palette("GrandBudapest1", n = 2))+
  theme_minimal() +
  xlab("Year") +
  ylab("Approval Count") 

ggplotly(Fig)
```

+ From \@ref(fig:fig5), it is evident that for **Kirwan**, the **maximum approvals** occurred in **2021** and for **Hermit Park**, the year was **2020**.