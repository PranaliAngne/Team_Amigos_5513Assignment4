---
title: "Amigos_Assignment4"
author: "Pranali Angne"
author: "Nishtha Arora"
author: "Raunak Bhivpathaki"
date: "5/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

The data used in the report is regarding building certification lodgements in the Townsville local government area. Townsville is a city and a major port area in eastern Queensland, Australia. The data set been extracted from [www.data.gov.au](https://data.gov.au/data/dataset/tcc-building-approvals). 

This data set includes number of building approvals from 2009 to 2021 and can be aggregated by month, suburb and local government electoral division.  

The objective of the report is to identify the year with maximum approvals and to analyze data regarding the building category maximum in demand i.e. the Suburb and total cost for that category.

\section*{1}


\section*{Q1, Part B}

``` {r libraries, echo= FALSE, warning= FALSE, message = FALSE}
library(tidyverse)
library(lubridate)
library(ggplot2)
library(kableExtra)
library(readr)
library(RColorBrewer)
library(randomcoloR)
library(plotly)
library(gapminder)
```

```{r reading_data, message=FALSE, warning=FALSE,echo=FALSE}
sec2 <-read_csv("data/building-approvals.csv") %>% 
  mutate(`Date Of Decision Notice` = dmy(`Date Of Decision Notice`),
        Year = year(`Date Of Decision Notice`)) 
```

### Finding **category** with maximum counts in Class 1a (approved projects), in 2020.

*(Keeping, 'Decision as Approved' and 'Class as 1a', constant and showing variation for years and identifying category count for 'Year 2020')*

```{r filtering, message=FALSE, warning=FALSE,echo=FALSE}
Filtered <- sec2 %>%  
  filter(Class == "Class 1a", Decision == "#Approved")
grouping <- Filtered %>% 
    group_by(Category, Year) %>% 
  count(Category) %>% 
  rename(Count =n)
```

```{r fig3, message=FALSE,warning=FALSE,echo=FALSE, fig.cap="Count v/s Category", fig.height= 5, fig.width=10, fig.align='center'}
df <- grouping
fig <- df %>%
  plot_ly(
    x = ~Category, 
    y = ~Count, 
    color = ~Category, 
    frame = ~Year, 
    type = 'scatter',
    mode = 'markers'
  )
fig
```

In figure \@ref(fig:fig3), by clicking on *play*, we observe that for half the years in the data set, *Residential-Other* category has been on the top and for the other half, *Single Detached Dwelling-New* has been in demand.

+ Identifying for the year 2020, we see that out of *Class 1a*, **Residential-Other** category is most in demand out of *approved projects* in the year *2020*.

### Finding **Suburb** for Residential category (Class 1a), approved projects in 2020.

*(Keeping, 'Year as 2020'. 'Decision as Approved', 'Class as 1a' and 'Category as Residential-Other', constant)*

```{r colours, echo= FALSE, warning= FALSE, message = FALSE}
 c50 <- c(
  "dodgerblue2", "#E31A1C",  "green4", "#6A3D9A",  "#FF7F00", "black", "gold1", "skyblue2", "#FB9A99", "palegreen2", "#CAB2D6", "#FDBF6F","gray70", "khaki2", "maroon", "orchid1", "deeppink1", "blue1", "steelblue4",
  "darkturquoise", "green1", "yellow4", "yellow3", "darkorange4", "brown", "pink1", "violet", "mediumpurple1", "slateblue1", "purple", "purple3",
"turquoise2", "skyblue", "steelblue", "blue2", "navyblue", "orange", "tomato", "coral2", "palevioletred", "violetred", "red2","springgreen2", "yellowgreen", "palegreen4", "wheat2", "tan", "tan2", "tan3", "brown",
 "grey70", "grey50", "grey30"
)
```

```{r fig4, message=FALSE, warning=FALSE, echo=FALSE, fig.width=10, fig.height=5, fig.cap= "Suburb v/s Approval Count", fig.align='center'}
polar <- Filtered %>% 
  filter(Year == "2020") %>% 
  filter( Category == "Residential - Other") %>% 
  select(Suburb, Decision, Category, Year ) %>% 
  group_by(Suburb) %>% 
count(Decision) %>% 
  rename(Total_Approvals = n) %>% 
  arrange(desc(Total_Approvals))

ggplot(polar,
       aes(y = Total_Approvals, x = Suburb, fill = Suburb)) +
  geom_col() +
 coord_polar() +
scale_fill_manual(values = c50) +
theme(axis.text = element_blank())
```

Figure \@ref(fig:fig4) shows that suburbs *Kirwan* and *Hermit Park* have the maximum approval count.

+ Therefore, the suburbs **Kirwan** and **Hermit Park**, have most no. of *class 1a*'s with category as *Residential-Other* in *approved projects* for *2020*.








\section*{3}