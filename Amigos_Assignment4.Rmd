---
title: "Amigos_Assignment4"
author: "Pranali Angne"
author: "Nishtha Arora"
author: "Raunak Bhivpathaki"
date: "5/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

The data used in the report is regarding building certification lodgements in the Townsville local government area. Townsville is a city and a major port area in eastern Queensland, Australia. The data set been extracted from [www.data.gov.au](https://data.gov.au/data/dataset/tcc-building-approvals). 

This data set includes number of building approvals from 2009 to 2021 and can be aggregated by month, suburb and local government electoral division.  

The objective of the report is to identify the year with maximum approvals and to analyze data regarding the building category maximum in demand i.e. the Suburb and total cost for that category.

\section*{1}


\section*{2}

```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(tidyverse)
library(readr)
library(lubridate)
library(kableExtra)
```

```{r, message=FALSE, warning=FALSE, echo=FALSE}
Sec2 <- read_csv("data/building-approvals.csv")
```

Q2. Which category is most in demand/occurs maximum times in the year 2020?

```{r Filtering, message=FALSE, warning=FALSE,echo=FALSE}
Filtered <- Sec2 %>%  mutate(`Date Of Decision Notice` = dmy(`Date Of Decision Notice`),
        Year = year(`Date Of Decision Notice`)) %>% 
  filter(Year == "2020")
```

```{r}
Tab <- Filtered %>% count(Category)  %>% 
  rename(Count = n) %>% 
  arrange(desc(Count))
knitr::kable(head(Tab), caption = "Count of categories in 2020") %>% 
   kable_paper("hover", full_width = T)
```

Q3. Which is the suburb, where it costs the maximum for the category  "Residential-Other", in the year 2020?

```{r, fig.height= 5, fig.width=5}
Fig <- Filtered %>% 
  filter(Category == "Residential - Other") %>% 
  rename(Estimated_Cost = `Estimated Cost`) %>% 
mutate(Estimated.Cost = as.factor(Estimated_Cost)) 
  Fig$Estimated.Cost = as.numeric(gsub("[\\$,]", "", Fig$Estimated.Cost)) 
  
  ggplot(Fig,
         aes(x= Estimated.Cost,
             y= Suburb, fill= Category))+
    geom_col() +
    scale_x_continuous(labels = scales::comma)
    
```







\section*{3}