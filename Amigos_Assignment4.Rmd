---
title: "Amigos_Assignment4"
author: "Pranali Angne"
author: "Nishtha Arora"
author: "Raunak Bhivpathaki"
date: "5/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\section*{Q1, Part A}

``` {r Loading-libraries, echo= FALSE, warning= FALSE, message = FALSE}
library(tidyverse)
library(lubridate)
library(ggplot2)
library(ggmap)
library(maps)
library(kableExtra)
library(readr)
library(plotly)
```


```{r reading-data, echo= FALSE, warning= FALSE, message = FALSE}
data <-read_csv("data/building-approvals.csv")
geometry <- read_csv("data/suburbs.csv")
join <- left_join(data, geometry)
```


```{r data-cleaning, echo=FALSE, warning= FALSE, message = FALSE}
question0 <- join %>% dplyr :: select (`Application Type`, 
                                      `Date Of Decision Notice`,
                                      Decision,
                                      Class,
                                      Subcategory,
                                      Category,
                                    `Estimated Cost` ,
                                      Suburb,
                                    Latitude,
                                    Longitude
                                      )
```

**Variable Names**

After data cleaning according to our research questions, we will be selecting the following variables:

```{r tab1, echo= FALSE, warning= FALSE, message = FALSE, out.width= "3%"}
summary <- colnames(question0)
knitr::kable(summary, col.names = gsub("[.]", " ", names(summary)), align = "l", caption = "Variable Names") %>% 
kable_paper("hover")
```

For table \@ref(tab:tab1), the **description of the variables** used in the data set:

+ **Application type**: Here, application for 'building certification lodgements'.

+ **Date of decision notice**: The date the building certifier made a notice that the works met the building codes.

+ **Decision**: Current status of the works as recorded with Council.

+ **Class**: The building classification as per the list on page one.

+ **Sub-category (Council category descriptors)**: This category is a subdivision of class. Provides information regarding additions, alterations, subdwell etc in it.

+ **Category**: Townsville City Council has published on its website for a number of years a summary of building approval data using the certain categories.

+ **Estimated values**: The monetary value of the proposed building work.

+ **Suburb**: The suburb where the building work is taking place.

+ **Latitude and Longitude**: Geometrical dimensions. 

## Answering **Research Question 1.**

### Finding **Year** with **maximum approvals** as a decision, overall.

```{r graph1, echo= FALSE, warning= FALSE, message = FALSE, fig.height= 5, fig.width=9, fig.cap= "Year v/s Decision count", fig.pos='H', fig.align='center'}
question1 <- question0 %>% 
  mutate(`Date Of Decision Notice` = dmy(`Date Of Decision Notice`),
        Year = year(`Date Of Decision Notice`))

question1.1 <- question1 %>% 
  select(Year, Decision) %>% 
  count(Decision, Year) %>% 
  rename(`Total number of Decision` = n)

# plotting this graph
graph1 <- ggplot(data = question1.1, aes(x = Year,
                             y = `Total number of Decision`, 
                             fill = Decision)) +
  geom_bar(stat="identity", position = "dodge") +
  scale_fill_brewer(palette="Dark2")+
  theme(plot.title = element_text(hjust = 0.5))+
  theme_get() +
  xlab("Year") +
  ylab("Total count of Decision") 

ggplotly(graph1)
```

From the graph \@ref(fig:graph1), we see that, **finalized projects have maximum count**, but we will **consider the count of approved projects** into consideration because: 

Finalized projects are projects sent by architects to be approved by the regulation committee and the approved projects are the **confirmed** projects. Thus, it makes more sense to consider approved projects over finalized while deciding the **best year**.

+ The year **2020** has maximum **approvals** till now.







\section*{2}


\section*{3}